#textdomain wesnoth-AD

[scenario]
    id=01_Orcish_Comradery
    name= _ "Orcish Comradery"
    map_data="{~add-ons/Ashievieres_Dogs/maps/01_Orcish_Comradery.map}"

    [event]
    name=prestart,new_turn 
    first_time_only=no

        {LIGHT_EFFECT ""}
    [/event] 

    #{RIVER_SLOW 32 25 4 10}
    #{RIVER_SLOW 34 20 4 10}
    #{RIVER_SLOW 36 10 4 10}

    {TURNS 30 28 26}
    next_scenario=02_Welcome_to_Wesnoth
    victory_when_enemies_defeated=yes
    carryover_percentage=40
    carryover_add=yes
    current_time=2

    {DEFAULT_SCHEDULE}

    {SCENARIO_MUSIC "knolls.ogg"}
    {EXTRA_SCENARIO_MUSIC "northerners.ogg"}
    {EXTRA_SCENARIO_MUSIC "battle.ogg"}

    [story]
        [part]
            story=_"With two kings dead in as many months, the Kingdom of Wesnoth stood in crisis."
            {AD_BIGMAP}
        [/part]
        [part]
            story=_"Garard II had been slain by his son Eldred, who was in turn felled by by Delfador the arch-mage. But even as Delfador struck the finishing blow, his dwindling host found itself scattered by the might of the late prince’s now-leaderless army."
            background=story/httt_story5.jpg
        [/part]
        [part]
            story=_"Taking advantage of the vacuum, countless local lords and provincial governors declared their independence, or announced their claims to the throne. Some found themselves allied with the arch-mage; some with each-other, all united against the traitorous remnants of Garard’s royal house."
            {AD_BIGMAP}
        [/part]
        [part]
            story=_"It became clear that the prince Eldred’s death had marked the beginning of civil war, not its end.

The queen Asheviere — Eldred’s mother — rushed to secure the capital; knowing that the King’s young nephews were next in line to the throne, she ordered them all killed, and declared herself Queen of Wesnoth. The rebellious lords, in turn, secured their domains and began hastily assembling a new army to overthrow the usurper of the throne."
            background=story/httt_story6.jpg
        [/part]
        [part]
            story=_"The queen’s position was grave: she controlled the capital province of Weldyn, but rebel banners rose over Soradoc, Tath, and Dan-Tonk. Leveraging previous successes against Garard, Asheviere dispatched messengers north beyond the Great River to enlist the support of once-unimaginable allies..."
            {AD_BIGMAP}
        [/part]
    [/story]

    {AD_TRACK {JOURNEY_01_NEW} }

    {STARTING_VILLAGES 1 4}
    {STARTING_VILLAGES 2 4}
    {STARTING_VILLAGES 3 4}

	[item]
		image="items/burial.png"
		submerge=1
		visible_in_fog=no
		x=7
		y=13
	[/item]
	[item]
		image="scenery/village-human-burned1.png"
		submerge=1
		visible_in_fog=no
		x=12
		y=20
	[/item]
	[item]
		image="scenery/whitefang-flag.png"
		submerge=1
		visible_in_fog=no
		x=13
		y=15
	[/item]
	[item]
		image="scenery/whitefang-flag.png"
		submerge=1
		visible_in_fog=no
		x=15
		y=18
	[/item]
	[item]
		image="scenery/village-human-burned3.png"
		submerge=1
		visible_in_fog=no
		x=17
		y=25
	[/item]
	[item]
		image="items/burial.png"
		submerge=1
		visible_in_fog=no
		x=18
		y=22
	[/item]
	[item]
		image="items/burial.png"
		submerge=1
		visible_in_fog=no
		x=27
		y=9
	[/item]

    [label]
        x,y=35,21
        text=_ "River Listra"
        immutable=yes
    [/label]

    #player average recruit cost = 17,6

    [side]
        side=1
        controller=human
        gold=125
        {INCOME 5 3 1}
        fog=no
        shroud=no
        share_vision=all
        {BAZUR_ARC_I}
        #recruit=Orcish Grunt,Orcish Archer,Wolf Rider,Goblin Spearman,Troll Whelp,Orcish Assassin
        color=white 
        team_name=bazur
        user_team_name= _ "Bazur"
        {FLAG_VARIANT ragged}
        save_id=bazur
    [/side]

    [side]
        side=2
        controller=ai
        {GOLD 50 75 100}
        income=0
        fog=no
        shroud=no
        share_vision=all
        type=Orcish Warrior
        id=Warlord_Troll
        name=_ "Hu'ug"
        profile="portraits/orcs/grunt-2.webp"
        [modifications]
            {TRAIT_STRONG}
        [/modifications]
        recruit=Orcish Grunt,Orcish Archer,Wolf Rider,Goblin Spearman,Troll Whelp
        color=blue
        team_name=bazur
        user_team_name= _ "Whitefang Orcs"
        {FLAG_VARIANT ragged}

        [ai]
        {NO_SCOUTS}
        grouping=no
        aggression={ON_DIFFICULTY "0.75" "0.85" "0.95"}
        recruitment_pattern=fighter,fighter,fighter,scout,archer

            [goal]
                [criteria]
                    side=1
                [/criteria]
                value=3
            [/goal]

            [goal]
                [criteria]
                    id=Bazur
                [/criteria]
                value={ON_DIFFICULTY "1.25" "2.25" "3.25"}
            [/goal]

            [aspect]
                id=recruitment_instructions
                [facet]
                    turns=1-2
                    [value] 
                        [recruit]
                            type=Troll Whelp
                            number=1
                        [/recruit]
                        [recruit]
                            importance=0
                        [/recruit]
                    [/value]
                [/facet]
            [/aspect]
        [/ai]

        [unit]
            type={ON_DIFFICULTY "Orcish Archer" "Orcish Archer" "Orcish Crossbowman"}
            name=_ "Orc Guard"
            x,y=13,16
            ai_special=guardian
            [modifications]
                #ifdef NORMAL
                    {TRAIT_RESILIENT}
                #endif
            [/modifications]
        [/unit]
        
        [unit]
            {MOOG}
            x,y=3,5
            ai_special=guardian
        [/unit]
        [unit]
            {GRUMP}
            x,y=9,6
            ai_special=guardian
        [/unit]
    [/side]

    [side]
        side=3
        controller=ai
        {GOLD 50 75 100}
        income=0
        fog=no
        shroud=no
        share_vision=all
        type=Orcish Warrior
        id=Warlord_Assassin
        name=_ "Ruksha"
        [modifications]
            {TRAIT_STRONG}
        [/modifications]
        profile="portraits/orcs/grunt-5.webp"
        recruit=Orcish Grunt,Orcish Archer,Wolf Rider,Goblin Spearman,Orcish Assassin
        color=green
        team_name=bazur
        user_team_name= _ "Whitefang Orcs"
        {FLAG_VARIANT ragged}

        [ai]
            {NO_SCOUTS}
            grouping=no
            aggression={ON_DIFFICULTY "0.75" "0.85" "0.95"}
            recruitment_pattern=archer,mixed fighter,scout,archer

            [goal]
                [criteria]
                    side=1
                [/criteria]
                value=3
            [/goal]

            [goal]
                [criteria]
                    id=Bazur
                [/criteria]
                value={ON_DIFFICULTY "1.25" "2.25" "3.25"}
            [/goal]

            [aspect]
                id=recruitment_instructions
                [facet]
                    turns=1-2
                    [value] 
                        [recruit]
                            type=Orcish Assassin
                            number=1
                        [/recruit]
                        [recruit]
                            importance=0
                        [/recruit]
                    [/value]
                [/facet]
            [/aspect]
        [/ai]

        [unit]
            type={ON_DIFFICULTY "Orcish Archer" "Orcish Archer" "Orcish Crossbowman"}
            name=_ "Orc Guard"
            x,y=14,17
            ai_special=guardian
            [modifications]
                #ifdef NORMAL
                    {TRAIT_RESILIENT}
                #endif
            [/modifications]
        [/unit]
        
        [unit]
            {ARSHAG}
            x,y=28,23
            ai_special=guardian
        [/unit]
        [unit]
            {GNORK}
            x,y=27,21
            ai_special=guardian
        [/unit]
    [/side]

    [side]
        side=4
        controller=null
        gold=0
        income=0
        fog=no
        shroud=no
        share_vision=all
        no_leader=yes
        recruit=
        color=red
        team_name=wesnothians
        user_team_name= _ "Asheviere's Forces"
        {FLAG_VARIANT loyalist}

        [ai]
            caution=0.99
            allow_ally_villages=yes
            [avoid]
                x,y=14,16
                radius=6
            [/avoid]
        [/ai]
    [/side]

    #Setup general AD events: 
    {AD_RECRUIT_EVENT}
    {AD_LOYALS_EVENTS}

    #hint for novice players 
    [event]
        name=recruit
        [filter]
            side=1
            type=Troll Whelp
        [/filter]
        [message]
            speaker=Bazur
            message=_ "About time you rockbrains got here! Remember what the chief said — you trolls fight as Whitefangs now."
        [/message]
        [object] 
            silent=no 
            name=_"Troll Whelp"
            image="units/trolls/whelp.png~RC(magenta>white)"
            duration=scenario
            description=_"Trolls often ally with orcs, and the Whitefang clan is no exception. Trolls have the <b><i>regeneration</i></b> ability, regaining 8 hitpoints or curing poison every turn as if they were in a village."
            [filter]
                find_in=unit 
            [/filter]
        [/object]
    [/event]
    
    
    
    #defensive AI leader behavior if player pushes 

    [event]
    name=side 2 turn 
    id=Huug_caution
    first_time_only=no 

        [if]
            [have_unit]
                side=1
                count=3-100 
                [not]
                    level=0 
                [/not]
                [filter_location]
                    x,y,radius=6,4,5
                [/filter_location]
            [/have_unit]
        [then]
            {MODIFY_SIDE_AI (2) (grouping=defensive)}
            {ADD_LEADER_GOAL 2 huug_stays_at_keep 6 4 no 1}

            {MODIFY_AI_ADD_GOAL 2 (
            [goal]
                id=defend_huug
                name=protect_unit
                [criteria]
                    id=Warlord_Troll
                [/criteria]
                value=100
            [/goal]
            )}
        [/then]
        [else]
            {MODIFY_SIDE_AI (2) (grouping=no)}

            [modify_ai]
                side=2
                action=delete
                path=aspect[leader_goal].facet[huug_stays_at_keep]
            [/modify_ai]

            [modify_ai]
                side=2
                action=delete
                path=goal[defend_huug]
            [/modify_ai]
        [/else]
        [/if]
    [/event]

    [event]
    name=side 3 turn 
    id=Ruksha_caution
    first_time_only=no 

        [if]
            [have_unit]
                side=1
                count=3-100 
                [not]
                    level=0 
                [/not]
                [filter_location]
                    x,y,radius=30,21,5
                [/filter_location]
            [/have_unit]
        [then]
            {MODIFY_SIDE_AI (3) (grouping=defensive)}
            {ADD_LEADER_GOAL 3 ruksha_stays_at_keep 30 21 no 1}

            {MODIFY_AI_ADD_GOAL 3 (
            [goal]
                id=defend_ruksha
                name=protect_unit
                [criteria]
                    id=Warlord_Assassin
                [/criteria]
                value=100
            [/goal]
            )}
        [/then]
        [else]
            {MODIFY_SIDE_AI (3) (grouping=no)}

            [modify_ai]
                side=3
                action=delete
                path=aspect[leader_goal].facet[ruksha_stays_at_keep]
            [/modify_ai]

            [modify_ai]
                side=3
                action=delete
                path=goal[defend_ruksha]
            [/modify_ai]
        [/else]
        [/if]
    [/event]

    [event]
        name=prestart 

        [micro_ai]
            side=2
            ai_type=simple_attack
            action=add

            ca_score=110000
            [filter]
                side=2
            [/filter]
            [filter_second]
                id=Bazur 
            [/filter_second]
        [/micro_ai]

        [micro_ai]
            side=3
            ai_type=simple_attack
            action=add

            ca_score=110000
            [filter]
                side=3
            [/filter]
            [filter_second]
                id=Bazur 
            [/filter_second]
        [/micro_ai]
    [/event]

    [event]
    name=start

        [unit]
            {WESNOTH_MESSENGER}
            id=messenger
            side=4
            x,y=2,27
            max_moves=0
            [modifications]
                {TRAIT_LOYAL_HERO}
            [/modifications]
        [/unit]

        [sound]
            name=horse-canter.wav
        [/sound]

        {MOVE_UNIT id=messenger 5 25}
        {GENERIC_UNIT 4 Cavalryman 2 27} {MOVE_UNIT x,y=2,27 3 25}
        {GENERIC_UNIT 4 Horseman   2 27} {MOVE_UNIT x,y=2,27 4 25}
        {GENERIC_UNIT 4 Cavalryman 2 27} {MOVE_UNIT x,y=2,27 5 27}
        {GENERIC_UNIT 4 Cavalryman 2 27} {MOVE_UNIT x,y=2,27 3 27}

        [message]
            sound=horn-signals/horn-3.ogg
            speaker=messenger
            message=_ "Orcs of the Whitefang clan! Asheviere, rightful Queen of Wesnoth, is gathering warriors to fight rebel claimants and invites You to join Her army as mercenaries. The Queen promises generous wages to those who answer Her call!"
        [/message]
        [message]
            speaker=Warlord_Troll
            message=_ "Push off, pinkskin! You’ve burnt down your fort and we’ve stayed north of the river — that was the deal. We’ve already won tribute from your worthless Wesnoth, so if we want more human gold we’ll just come and take it!"
        [/message]
        [message]
            speaker=Warlord_Assassin
            message=_ "Tell your Queen to shove it, flat-face! Only a runtling or a Blackcrest would take orders from some kingdom whose ass we just kicked!"
        [/message]
        {DELAY 250}

        [message]
            speaker=Bazur
            message=_ "Only a runtling!? I’ll go with the humans, Rushka; I’ll agree to their deal. You call me a runtling to my face and just see what happens!"
        [/message]
        [message]
            speaker=Warlord_Troll
            message=_ "Bazur?! What kind of self-respecting orc would grovel and beg for human scraps?"
        [/message]
        [message]
            speaker=Bazur
            message=_ "I fought the flat-face king just as hard as any of you ingrates, but filthy Ushka’e always gives me the smallest part of the tribute. I deserve better, and if you’re all too elf-brained to listen then I’ll prove it to the humans instead!"
        [/message]
        [message]
            speaker=Warlord_Assassin
            message=_ "You jealous worm, the High Chief has divided tribute fairly based on merit — that’s why I always get the most! Don’t dishonor the Whitefangs; you’re not going anywhere!"
        [/message]
        [message]
            speaker=Bazur
            message=_ "Where I do or don’t go is none of your business, runt. Just try and stop me!"
        [/message]
        
        [modify_side]
            side=4
            team_name=bazur
        [/modify_side]
        [modify_side]
            side=2,3
            team_name=evil_orcs
        [/modify_side]
        {DELAY 250}

        [message]
            speaker=messenger
            message=_ "At least one of the three. Well! I hope the other messengers had more luck.

Gather your warriors and march to the border, orc, and prepare to be sworn in to Her Majesty’s auxiliaries."
        [/message]
        [message]
            speaker=Bazur
            message=_ "<i>(One of the three, hmm... Hu’ug and Ruksha are idiots, but strong idiots; their warriors follow them out of fear. If I slaughter them on my way out, I bet their best fighters will come join me instead!)</i>"
        [/message]
        
        
        {DELAY 500}
        [message]
            speaker=Bazur
            message=_ "...well? What’re you pinkskins doing? Don’t stand around like cowards (even if you probably are) — get in here and help me fight!"
        [/message]
        [message]
            speaker=messenger
            message=_ "Well... I suppose there’d be no harm in letting the men wet their swords. Which of your foes shall we charge, orc?"
        [/message]
        [message]
            speaker=Bazur
            [option]
                    label=_ "Send the Wesnoth riders against Hu’ug! (the northwest chief)"
                    [command]
                        {MODIFY_AI_ADD_GOAL 4 (
                            [goal]
                                id=target
                                [criteria]
                                    side=2
                                [/criteria]
                                value=10
                            [/goal]
                        )}
                        [modify_side]
                            side=4
                            controller=ai
                        [/modify_side]
                    [/command]
            [/option]
            [option]
                    label=_ "Send the Wesnoth riders against Ruksha! (the southeast chief)"
                    [command]
                        {MODIFY_AI_ADD_GOAL 4 (
                            [goal]
                                id=target
                                [criteria]
                                    side=3
                                [/criteria]
                                value=10
                            [/goal]
                        )}
                        [modify_side]
                            side=4
                            controller=ai
                        [/modify_side]
                    [/command]
            [/option]
            [option]
                label=_ "Don’t deploy the Wesnoth riders."
                [command]
                    [message]
                        speaker=messenger
                        message=_ "Why ask me to fight and then tell me to stay put? Small wonder you dumb beasts lost the war."
                    [/message]
                [/command]
            [/option]
        [/message]
        
        
        [objectives]
            silent=no
                [objective]
                    description= _ "Move Bazur adjacent to the Wesnoth messenger"
                    condition=win
                [/objective]
                [objective]
                    {ALTERNATIVE_OBJECTIVE_CAPTION}
                    description= _ "Defeat all enemy leaders"+{OBJECTIVE_FOOTNOTE _"(surviving orcs will join you)"}
                    condition=win
                [/objective]
                [objective]
                    description= _ "Death of Bazur"
                    condition=lose
                [/objective]
                [objective]
                    description= _ "Death of Wesnoth’s messenger"
                    condition=lose
                [/objective]
                {TURNS_RUN_OUT}
                [gold_carryover]
                    carryover_percentage=40
                    bonus=yes
                [/gold_carryover]
                [note]
                    description="When you kill an enemy leader, any of their surviving units will join Bazur"
                [/note]
        [/objectives]   
    [/event]
    
    # messenger's riders die
    [event]
        name=die
        [filter]
            side=4
            canrecruit=no
        [/filter]
        [filter_condition]
            [have_unit]
                side=4
                count=0-1
            [/have_unit]
        [/filter_condition]
        [message]
            speaker=messenger
            message=_ "My riders! How am I supposed to recruit more Whitefangs without proper protection?"
        [/message]
        [message]
            speaker=Bazur
            message=_ "Hah, less competition for me! The fewer pinkskins running around Whitefang lands the better."
        [/message]
    [/event]
    
    
    
    
    
    #победа - передвижение
    [event]
        name=moveto
        first_time_only=yes

        [filter]
            id=Bazur
            [filter_location]
                x,y=5,25
                radius=1
            [/filter_location]
        [/filter]

        [message]
            speaker=messenger
            message=_ "Well done, orc. Be sure you’ll earn more in service of the rightful queen than you could ever have in any of your raids."
        [/message]
        
        [if]
            [have_unit]
                canrecruit=yes
                side=2,3
            [/have_unit]
            [then]
                [message]
                    speaker=Bazur
                    message=_ "Hah, that’s right. Enjoy your penniless stay, the rest of you; when I get back I’ll be richer than the chief himself!"
                [/message]
            [/then]
            [else]
                [message]
                    speaker=Bazur
                    message=_ "Hah, that’s right. When I get back I’ll be richer than the chief himself! Too bad those losers Hu’ug and Ruksha won’t be here to see it!"
                [/message]
            [/else]
        [/if]

        [endlevel]
            result=victory
            {NEW_GOLD_CARRYOVER 40}
        [/endlevel]
    [/event]

    [event]
        name=die
        [filter]
            id=Warlord_Troll
        [/filter]
        [message]
            speaker=Bazur
            message=_ "So much for the great Hu’ug. You should have come to Wesnoth with me when you had the chance."
        [/message]
        [message]
            id=Grump
            [or]
                side=2
            [/or]
            message=_ "Hu’ug was stupid. We want go to Wesnoth with Bazur!"
        [/message]
        {MODIFY_UNIT side=2 side 1}
    [/event]
    [event]
        name=last_breath
        [filter]
            id=Warlord_Assassin
        [/filter]
        [message]
            speaker=Bazur
            message=_ "Ha! Who’s a runtling now, Ruksha?"
        [/message]
        [message]
            speaker=unit
            message=_ "You, because you sell yourself to the humans! I die a true orc!"
        [/message]
    [/event]
    [event]
        name=die
        [filter]
            id=Warlord_Assassin
        [/filter]
        [message]
            id=Arshag
            [or]
                side=3
            [/or]
            message=_ "Bah, let him die a true orc. I want to live a rich orc, fat on human gold!"
        [/message]
        {MODIFY_UNIT side=3 side 1}
    [/event]

    [event]
        name=enemies_defeated

        [message]
            speaker=Bazur
            message=_ "Now there’s no one left to trap me here. I am the strongest of them all, ha ha ha!"
        [/message]

        [modify_unit]
            [filter]
                id=Bazur 
            [/filter]
            [modifications]
                {TRAIT_QUICK}
                {TRAIT_STRONG}
            [/modifications]
        [/modify_unit]

        [object]
            silent=no 
            name= _ "Bazur the Strong"
            image="attacks/sword-orcish.png"
            duration=scenario
            description= _ "Bazur had proven that he was the strongest of the Whitefang chieftains! He gets the <i>strong</i> trait."
            [filter]
                id=Bazur
            [/filter]
        [/object]

        [set_achievement]
            content_for=ashevieres_dogs
            id=ad_strong
        [/set_achievement]

        [message]
            speaker=messenger
            message=_ "Well done, beast. Be sure that the Queen will greatly appreciate Your military skills."
        [/message]

        [endlevel]
            result=victory
            {NEW_GOLD_CARRYOVER 40}
        [/endlevel]
    [/event]

    [event]
    name=last_breath

        [filter]
            id=messenger
        [/filter]
        [filter_second]
            side=2,3
        [/filter_second]

        [message]
            speaker=second_unit
            message=_ "The messenger is dead! Hah, now Bazur the worm won’t go anywhere, and he won’t get any more gold than we do!"
        [/message]
        [message]
            speaker=Bazur
            message=_ "Runts! Worms! Idiots! That messenger was my best chance to finally get out of this hole."
        [/message]
        [endlevel]
            result=defeat 
        [/endlevel]
    [/event]

    [event]
    name=time over 

        [message]
            speaker=messenger
            message=_ "I can’t wait for you forever, orc. If you won’t serve the Queen, I’m sure Whitefangs elsewhere will be more than happy to — as soon as I get more riders for escorts."
        [/message]
        [sound]
            name=horse-canter.wav
        [/sound]
        {MOVE_UNIT id=messenger 2 27}
        [kill]
            id=messenger
            animate=no 
        [/kill]
        [message]
            speaker=Bazur
            message=_ "Runts! Worms! Idiots! That messenger was my best chance to finally get out of this hole."
        [/message]
    [/event]

    [event]
        name=last_breath
        [filter]
            id=Bazur 
        [/filter]
        [message]
            speaker=Bazur 
            message=_ "What could be worse than dying so pointlessly..."
        [/message]
    [/event]
[/scenario]
